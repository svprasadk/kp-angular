<div class="col-sm-12 mar-top-40" *ngIf="productAttributenotAdded">
  <div class="col-sm-12">
    <button class="btn back-btn" (click)="backClicked()">
      <mat-icon class="icon-pos">chevron_left
      </mat-icon>
      <span class="back-class">Back</span>
    </button>
    <span>
      <h4 class="lh-50 dis-in-b mar-l-20" *ngIf="!editHeadingId">Add Attributes</h4>
      <h4 class="lh-50 dis-in-b mar-l-20" *ngIf="editHeadingId">Edit Attributes</h4>

    </span>
  </div>
  <div class="col-sm-12 mar-top-40">
    <h4>Product: {{productDetail.productName}}</h4>
  </div>

  <div class="col-sm-12">
    <form #f="ngForm" novalidate>


      <div class="form-group pro-title">
        <label>Heading*
          <span class="suggestion">(Heading can be at most 60 characters)</span>
        </label>
        <input type="text" class="form-control" [(ngModel)]="heading" name="heading" #head="ngModel" maxlength="60" required>
        <p class="error" *ngIf="!head.valid && head.touched || !head.valid && submitted">Heading is required</p>

      </div>
      <div class="col-sm-11">
        <mat-accordion>
          <mat-expansion-panel *ngFor="let subhead of subHeadingArray; let r = index;" class="custom-header" hideToggle="true" #example>
            <mat-expansion-panel-header>
              <mat-panel-title>
                {{subhead.subHeading}}
              </mat-panel-title>
              <mat-panel-description class="text-right">
                <i class="material-icons blue right-50" (click)="Editsubhead($event, subhead, r)">
                  create
                </i>
                <i class="material-icons red right-70" (click)="deletesubhead($event, subhead,r)">
                  delete
                </i>
                <mat-icon class="right-20" *ngIf="!example.expanded">add</mat-icon>
                <mat-icon class="right-20" *ngIf="example.expanded">remove</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <div class="col-sm-12" *ngIf="subhead.contentFormat=='image'">
              <div class="col-md-5 margin-5" *ngFor="let image of subhead.images">
                <img src="{{image}}" width="60%" style="margin:0 auto;">
              </div>
            </div>
            <div class="col-sm-12" *ngIf="subhead.contentFormat=='pdf'">
              <div class="col-sm-12" *ngFor="let pdf of subhead.pdfs">

                <embed [src]="sanitizer.bypassSecurityTrustResourceUrl(pdf)" type="application/pdf" width="800px" height="400px">
              </div>
            </div>
            <div class="col-sm-12" *ngIf="subhead.contentFormat=='text'">
              <div [innerHTML]="subhead.text"></div>
            </div>

            <div class="col-sm-12" *ngIf="subhead.contentFormat=='videofile'">
              <div class="col-md-5 margin-5" *ngFor="let vid of subhead.videourls">
                <video width="320" height="240" controls>
                  <source src="{{vid}}"> Your browser does not support the video tag.
                </video>
              </div>
            </div>
            <div class="col-sm-12" *ngIf="subhead.contentFormat=='videoUrl'">
              <div class="col-md-5 margin-5" *ngFor="let vid of subhead.videoURl">
                <iframe width="320" height="240" [src]="getYouTubeUrlSanatize(vid)" frameborder="0" allowfullscreen>
                </iframe>
              </div>
            </div>

          </mat-expansion-panel>

        </mat-accordion>
      </div>
      <div class="col-sm-12 mar-top-20">
        <div class="col-sm-7">
          <div class="form-group pro-title">
            <label>Sub Heading *</label>
            <input type="text" class="form-control" [(ngModel)]="subHeading" name="subheading" #subhead="ngModel" required>
            <p class="error" *ngIf="!subhead.valid && subhead.touched || !subhead.valid && submitted">Sub Heading is required</p>

          </div>
        </div>
        <div class="col-sm-5 pad-top-50">
          <mat-checkbox class="example-margin" [(ngModel)]="isLocationChecked" name="check" disableRipple>
            <h4 class="mar-0 text-color-grey pos-rel lh-30">Location
              <span class="bottomtip">If location based select city and zone</span>
            </h4>

          </mat-checkbox>
        </div>
      </div>
      <div class="col-sm-12 mar-top-20" *ngIf="isLocationChecked">

        <div class=" form-inline">
          <div class="form-group top-Select">
            <!-- <label for="sel1">Zone*</label>
            <select class="form-control" id="sel1" [(ngModel)]="zone" name="zone" #zones="ngModel" (change)="zoneChanged()" required>
              <option value="">Select Zone</option>
              <option vlaue="East">East</option>
              <option value="West">West</option>
              <option value="North">North</option>
              <option value="South">South</option>
            </select>
            <p class="error zone-error" *ngIf="!zones.valid && zones.touched || !zones.valid && submitted">Select a Zone</p> -->

            <mat-form-field [style.fontSize.px]=17>
              <mat-select placeholder="Zone" [(ngModel)]="zone" name="zone" #zones="ngModel" (change)="zoneChanged()" required>


                <mat-option value="East">East</mat-option>
                <mat-option value="West">West</mat-option>
                <mat-option value="North">North</mat-option>
                <mat-option value="South">South</mat-option>

              </mat-select>
            </mat-form-field>
          </div>

          <div class="form-group top-Select">

            <mat-form-field [style.fontSize.px]=17>
              <input matInput placeholder="City" aria-label="City" [matAutocomplete]="auto" name="city" [formControl]="cityCtrl" required>
              <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let cityi of filteredCities | async" [value]="cityi">
                  <span>{{ cityi }}</span>
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>


            <!-- <label for="sel2">City*</label>
          
            <input class="form-control" id="sel2" [(ngModel)]="city" name="city" #cities="ngModel" required>
            <p class="error zone-error" *ngIf="!cities.valid && cities.touched || !cities.valid && submitted">Enter a City</p> -->

          </div>


        </div>
      </div>
      <div class="col-sm-12 mar-top-20">
        <div class="col-sm-12 ">
          <h4 class="label-title">Select Content Format*</h4>

          <mat-radio-group class="example-radio-group" [(ngModel)]="contenttype" name="contenttype" (change)="contentTypeChange()"
            required>
            <mat-radio-button class="example-radio-button" value="text" disableRipple>
              Text
            </mat-radio-button>
            <mat-radio-button class="example-radio-button" value="pdf" disableRipple>
              PDF
            </mat-radio-button>
            <mat-radio-button class="example-radio-button" value="image" disableRipple>
              Image
            </mat-radio-button>
            <mat-radio-button class="example-radio-button" value="videofile" disableRipple>
              Video File
            </mat-radio-button>
            <mat-radio-button class="example-radio-button" value="videoUrl" disableRipple>
              Video Url
            </mat-radio-button>

          </mat-radio-group>
          <p class="error zone-error" *ngIf="!contenttype && submitted">Select content type</p>

        </div>
        <div class="col-sm-12 mar-top-20" *ngIf="contenttype==='text'">
          <quill-editor [(ngModel)]="subheadDescription" name="description" [style]="{'height': '200px'}">
            <div quill-editor-toolbar>
              <span class="ql-formats">
                <select class="ql-font">
                  <option selected></option>
                  <option value="serif"></option>
                  <option value="monospace"></option>
                </select>
                <select class="ql-size">
                  <option value="small"></option>
                  <option selected></option>
                  <option value="large"></option>
                  <option value="huge"></option>
                </select>
              </span>
              <span class="ql-formats">
                <button class="ql-bold"></button>
                <button class="ql-italic"></button>
                <button class="ql-underline"></button>
                <button class="ql-strike"></button>
              </span>
              <span class="ql-formats">
                <select class="ql-color"></select>
                <select class="ql-background"></select>
              </span>
              <span class="ql-formats">
                <button class="ql-list" value="ordered"></button>
                <button class="ql-list" value="bullet"></button>
                <select class="ql-align">
                  <option selected></option>
                  <option value="center"></option>
                  <option value="right"></option>
                  <option value="justify"></option>
                </select>
              </span>
              <span class="ql-formats">
                <button class="ql-link"></button>
              </span>
            </div>
          </quill-editor>
        </div>

        <div class="col-sm-12 mar-top-20" *ngIf="contenttype==='pdf'">
          <label for="filePdf" class="fileBrowseBtn">
            Browse
          </label>
          <span class="text-color-grey" *ngIf="pdfData.length">{{pdfData.length}} File{{pdfData.length>1?'s':''}} Attached</span>
          <input type="file" id="filePdf" accept="application/pdf" (change)="pdfFileChange($event)" multiple/>
          <div class="pdfBlock" *ngFor="let file of pdfData; let m=index;">
            <mat-icon class="pos-abs-icon" (click)="deletepdf(m)">cancel</mat-icon>

            <a>
              <img src="assets/PDF_icon.svg">
            </a>
          </div>
        </div>

        <div class="col-sm-12 mar-top-20" *ngIf="contenttype==='image'">
          <label for="fileimg" class="fileBrowseBtn">
            Browse
          </label>
          <span class="text-color-grey" *ngIf="urls.length">{{urls.length}} File{{urls.length>1?'s':''}} Attached</span>
          <input type="file" id="fileimg" accept="image/*" (change)="imgFileChange($event)" multiple/>
          <div class="imgBlock" *ngFor="let url of urls;let k=index;">
            <mat-icon class="pos-abs-icon" (click)="deleteImg(k)">cancel</mat-icon>

            <a>
              <img src="{{url}}">
            </a>
          </div>
        </div>

        <div class="col-sm-12 mar-top-20" *ngIf="contenttype==='videofile'">
          <label for="filevid" class="fileBrowseBtn">
            Browse
          </label>
          <span class="text-color-grey" *ngIf="videoUrls.length">{{videoUrls.length}} File{{videoUrls.length>1?'s':''}} Attached</span>
          <mat-spinner *ngIf="loadingvideo"></mat-spinner>


          <input type="file" id="filevid" accept="video/*" (change)="vidFileChange($event)" multiple/>
          <div class="vidBlock" *ngFor="let videourl of videoUrls; let l=index;">
            <mat-icon class="pos-abs-icon" (click)="deletevideo(l)">cancel</mat-icon>
            <!-- <iframe [src]='sanitizer.bypassSecurityTrustResourceUrl(videourl)' class="videoblock"></iframe> -->
            <video width="80" height="80" controls class="videoblock">
              <source src="{{videourl}}">
              <!-- <source src="movie.ogg" type="video/ogg"> Your browser does not support the video tag. -->
            </video>
          </div>
        </div>
        <div class="col-sm-12 mar-top-20" *ngIf="contenttype==='videoUrl'">
          <div class="form-group form-inline pro-title">
            <label>Video Url</label>
            <input type="text" class="form-control videourl-input" pattern="{{videoReg}}" [(ngModel)]="videoUrl" name="videoUrl" #videour="ngModel">
            <span (click)="addVideoUrls(videour)" [ngClass]="{'disableclick':!videour.valid}">
              <mat-icon class="icon-add">add_circle</mat-icon>
            </span>
            <p class="error" *ngIf="videour.touched && !videour.valid">Wrong url</p>

          </div>
          <div *ngFor="let url of videoUrlsUrl; let p=index;">
            <div>
              <a href="https://www.youtube.com/watch/{{url}}" target="_blank">Video</a>
              <mat-icon class="n" (click)="deleteurl(p)">cancel</mat-icon>

            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-12 text-right mar-top-20px" *ngIf="!editHeadingId">
        <button class="btn border-btn" (click)="saveAndAddNew()" [disabled]="!f.valid ||(isLocationChecked && !cityCtrl.value)">Save & Add new</button>
        <button class="btn cancel-btn" (click)="cancelAttributeadding()">CANCEL</button>
        <!-- Author:Sateesh, Date:14/03/2019
        Create button for add publish now or later -->
        <button type="submit" *ngIf="isPublished" class="btn submit-btn" (click)="saveAndAddNew(true)" [disabled]="!heading || (!subHeadingArray.length && !f.valid) ||(isLocationChecked && !cityCtrl.value)">ADD</button>
        <button type="submit" *ngIf="!isPublished" class="btn submit-btn widthauto" (click)="saveAndAddNew(true)" [disabled]="!heading || (!subHeadingArray.length && !f.valid) ||(isLocationChecked && !cityCtrl.value)">Add & Publish Later</button>
        <button type="submit" *ngIf="!isPublished" class="btn submit-btn widthauto" (click)="doPublish=true; saveAndAddNew(true)"
          [disabled]="!heading || (!subHeadingArray.length && !f.valid) ||(isLocationChecked && !cityCtrl.value)">Add & Publish Now</button>

      </div>
      <div class="col-sm-12 text-right mar-top-20px" *ngIf="editHeadingId">
        <!-- <button class="btn border-btn" (click)="saveAndAddNew()" [disabled]="!f.valid">Save & Add new</button>-->
        <button class="btn cancel-btn" routerLink="/admin/products/details/{{productId}}">CANCEL</button>
        <button type="submit" class="btn submit-btn" (click)="saveAndAddNew(true)" [disabled]="!heading ">UPDATE</button>

      </div>
    </form>


  </div>



</div>

<div class="col-sm-12 Aligner ht-95" *ngIf="!productAttributenotAdded">
  <div class="Aligner-item">
    <h3 class="clr-green">Product Attributes has been successfully Added</h3>
    <div class="col-sm-12">
      <button class="btn action-btn vpl" routerLink="/admin/products">View Product List</button>
      <button class="btn action-btn liteblue-btn vpl" (click)="productAttributenotAdded = true;">Add More Attributes</button>

      <!-- <button class="btn action-btn liteblue-btn vpl">Add Attributes</button> -->

    </div>
  </div>
</div>